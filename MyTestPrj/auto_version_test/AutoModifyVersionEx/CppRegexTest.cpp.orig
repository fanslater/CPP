#include "StdAfx.h"
#include "CppRegexTest.h"
#include <regex>
#include "tstring.h"
#include <iostream>
using namespace std;

CppRegexTest::CppRegexTest( void )
{
}

CppRegexTest::~CppRegexTest( void )
{
}



void CppRegexTest::regex_match()
{    
    tstring str = "Hello_2018";
    tr1::smatch result;
    tr1::regex pattern( "(.{5})_(\\d{4})" ); //匹配5个任意单字符 + 下划线 + 4个数字
    if( tr1::regex_match( str, result, pattern ) )
    {
        cout << result[0] << endl;      //完整匹配结果，Hello_2018
        cout << result[1] << endl;      //第一组匹配的数据，Hello
        cout << result[2] << endl;      //第二组匹配的数据，2018
        cout << "结果显示形式2" << endl;
        cout << result.str() << endl;   //完整结果，Hello_2018
        cout << result.str( 1 ) << endl; //第一组匹配的数据，Hello
        cout << result.str( 2 ) << endl; //第二组匹配的数据，2018
    }
    //遍历结果
    for( int i = 0; i < result.size(); ++i )
    {
        cout << result[i] << endl;
    }
    cout << endl;
}

void CppRegexTest::regex_search()
{
    string str = "Hello 2018, Bye 2017";
    tr1::smatch result;
    tr1::regex pattern( "\\d{4}" );  //匹配四个数字
    //迭代器声明
    string::const_iterator iterStart = str.begin();
    string::const_iterator iterEnd = str.end();
    string temp;
    while( tr1::regex_search( iterStart, iterEnd, result, pattern ) )
    {
        temp = result[0];
        cout << temp << endl;
        iterStart = result[0].second;   //更新搜索起始位置,搜索剩下的字符串
    }
    cout << endl;
}

void CppRegexTest::regex_replace()
{
        string str = "Hello_2018!";
    tr1::regex pattern( "Hello" );
    cout << tr1::regex_replace( str, pattern, tstring( "" ) ) << endl; //输出：_2018，将Hello替换为""
    cout << tr1::regex_replace( str, pattern, tstring( "233" ) ) << endl; //输出：_2018，将Hello替换为2333
    tr1::regex pattern2( "(.{3})(.{2})_(\\d{4})" );  //匹配3个任意字符+2个任意字符+下划线+4个数字
    cout << tr1::regex_replace( str, pattern2, tstring( "$1$3" ) ) << endl; //输出：Hel2018，将字符串替换为第一个和第三个表达式匹配的内容
    cout << tr1::regex_replace( str, pattern2, tstring( "$1$3$2" ) ) << endl; //输出：Hel2018lo，交换位置顺序
    cout << endl;
}

void CppRegexTest::ignore_case()
{
    cout << tr1::regex_match( "aaaAAA", tr1::regex( "a*", tr1::regex::icase ) ) << endl; //结果为1
    cout << tr1::regex_match( "aaaAAA", tr1::regex( "a*" ) ) << endl;             //结果为0
    cout << endl;
}
